<div class="card">
  <div class="card-header  d-flex justify-content-between">
    <span>Variantes</span>
    <button  type="button"class="btn btn-sm btn-outline-success"><i class="bi bi-backspace"></i></button>
  </div>

  <div class="card-body">
   <button  type="button"class="btn btn-sm btn-outline-success" (click)="open()"><i class="bi bi-file-earmark-plus-fill"></i></button>
    <div id="details" style="overflow-x: auto">

      <table
        class="table table-responsive-sm table-sm mt-2"
        id="tableProducts"
      >
        <thead>
          <tr>
            <th>Imagen</th>
            <th></th>
            <th>Id</th>
            <th>Código</th>
            <th>Código barra</th>
            <th>Producto</th>
            <th>Presentación</th>
            <th>Variedad</th>
            <th>UM</th>
            <th>%Iva</th>
            <th>Activo</th>
          </tr>
        </thead>

        <tbody id="variantes">
          @for (variante of variantes(); track variante.id; let index = $index)
          {
          <tr class=" ">
            <td
              align="center"
              class="w70"
              align="center"
              style="background: white"
            >
              <img
                *ngIf="variante.img"
                [attr.src]="variante.img | imagen: 'productos' | async"
                class="img-producto60"
              />
            </td>
            <td class="field">
              <input class="form-control" type="file" id="formFile" />
            </td>
            <td class="field">{{ variante.id }}</td>
            <td class="field">
              <input
                class="form-control form-control-sm validation"
                [(ngModel)]="variante.codErp"
                type="number"
                name="codErp"
                id="codErp"
              />
            </td>
            <td class="field">
              <input
                class="form-control form-control-sm validation"
                [(ngModel)]="variante.codBarra"
                type="number"
                name="codBarra"
                id="codBarra"
              />
            </td>

            <td class="field">
              <select
                class="custom-select custom-select-sm"
                id="presentacionId"
                [(ngModel)]="variante.presentacionId"
              >
                <option
                  *ngFor="let presentacion of presentaciones()"
                  [value]="presentacion.id"
                >
                  {{ presentacion.descripcion }}
                </option>
              </select>
            </td>

            <td class="field">
              <select
                class="custom-select custom-select-sm"
                id="variedadId"
                [(ngModel)]="variante.variedadId"
              >
                <option
                  *ngFor="let variedad of variedades()"
                  [value]="variedad.id"
                >
                  {{ variedad.descripcion }}
                </option>
              </select>
            </td>
            <td class="field">
              <select
                class="custom-select custom-select-sm"
                id="unidadId"
                [(ngModel)]="variante.unidadId"
              >
                <option *ngFor="let unidad of unidades()" [value]="unidad.id">
                  {{ unidad.descripcion }}
                </option>
              </select>
            </td>
            <td class="field">
              <input
                class="form-control form-control-sm validation"
                [(ngModel)]="variante.porcIva"
                type="number"
                name="porcIva"
                id="porcIva"
              />
            </td>
            <td class="field">
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="activo"
                  [(ngModel)]="variante.activo"
                  checked=""
                />
              </div>
            </td>
            <td class="field">
              <button
                type="button"
                class="btn btn-sm btn-outline-success"
                (click)="actualizar(variante)"
              >
                Actualizar
              </button>
            </td>
          </tr>
          }@empty { <tr></tr> }
        </tbody>
      </table>

    </div>
  </div>
</div>
<app-ng-modal [isOpen]="isOpen" (closeModal)="isOpen=false">



  <form [formGroup]="varianteForm" (ngSubmit)="onSubmit($event)">
    <div class="form-row">
      <div class="card">
        <div class="card-body">
            <h4 class="card-title">Avatar</h4>
            <h6 class="card-subtitle">Imagen del usuario</h6>

            <div class="text-center">
              <!--   <img *ngIf="!imgTemp" [src]="usuario.imagenUrl" class="img-avatar"> -->
                <img *ngIf="imgTemp" [src]="imgTemp" class="img-avatar"/>
            </div>

            <input type="file" (change)="cambiarImagen($event)">

            <br>
            <br>

           <!--  <button type="button"
                    class="btn btn-success btn-block waves-effect waves-light m-r-10"
                    [disabled]="!imagenSubir"
                    (click)="subirImagen()">
                <i class="fa fa-save"></i>
                Cambiar imagen
            </button> -->

        </div>

      </div>
      <div class="form-group col-md-2">
        <label for="codBarra">Código de Barras</label>
        <input type="text" class="form-control" formControlName="codBarra" />
      </div>
      <div class="form-group col-md-2">
        <label for="codErp">Código ERP</label>
        <input type="text" class="form-control" formControlName="codErp" />
      </div>
      <div class="form-group col-md-2">
        <label for="porcIva">Porcentaje IVA</label>
        <input type="text" class="form-control" formControlName="porcIva" />
      </div>
      <div class="form-group col-md-2">
        <label for="productoId">Producto</label>
        <select class="form-control" formControlName="productoId">
          <option *ngFor="let producto of productos()" [value]="producto.id">
            {{ producto.nombre }}
          </option>
        </select>
      </div>
      <div class="form-group col-md-2">
        <label for="presentacionId">Presentación</label>
        <select class="form-control" formControlName="presentacionId">
          <option *ngFor="let presentacion of presentaciones()" [value]="presentacion.id">
            {{ presentacion.descripcion }}
          </option>
        </select>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group col-md-2">
        <label for="variedadId">Variedad</label>
        <select class="form-control" formControlName="variedadId">
          <option *ngFor="let variedad of variedades()" [value]="variedad.id">
            {{ variedad.descripcion }}
          </option>
        </select>
      </div>
      <div class="form-group col-md-2">
        <label for="unidadId">Unidad</label>
        <select class="form-control" formControlName="unidadId">
          <option *ngFor="let unidad of unidades()" [value]="unidad.id">
            {{ unidad.descripcion }}
          </option>
        </select>
      </div>
      <div class="form-group col-md-2">
        <label for="activo">Activo</label>
        <input class="form-check-input" type="checkbox" formControlName="activo" checked />
      </div>
      <div class="form-group col-md-2">
        <button type="submit" class="btn btn-primary">Crear Variante</button>
      </div>
    </div>
  </form>




</app-ng-modal>
